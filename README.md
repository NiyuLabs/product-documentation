---
description: Connects Odoo to Microsoft online
---

# Excel Online Connector

### 1. Introduction <a href="#id-1-introduction" id="id-1-introduction"></a>

The  Excel Online Connector enables seamless, secure export of your Odoo ERP data directly to Microsoft Excel files stored in OneDrive. This tool is ideal for real-time reporting, analytics, and sharing data with stakeholders using Excel Online.

***

### 2. Key Features <a href="#id-2-key-features" id="id-2-key-features"></a>

* **Direct export** of Odoo data to Excel files in OneDrive.
* **Secure authentication** using Azure AD credentials.
* **Automatic token and drive management** for hassle-free operation.
* **Flexible field selection** and filtering for customized exports.
* **Scheduled or manual exports** for up-to-date reporting.
* **Comprehensive logs and access control** for security and auditing.

***

### 3. Prerequisites <a href="#id-3-prerequisites" id="id-3-prerequisites"></a>

Before configuring the connector, ensure you have:

* Access to your company’s [Azure Portal](https://portal.azure.com/) (admin rights recommended).
* A registered Azure AD application with Microsoft Graph API permissions.
* An Excel file created in the target user’s OneDrive account.

***

### 4. Where to Find Required IDs and Credentials <a href="#id-4-where-to-find-required-ids-and-credentials" id="id-4-where-to-find-required-ids-and-credentials"></a>

To connect Odoo to Excel Online, you’ll need the following:

### **Tenant ID**

* **Where:** Azure Portal → Azure Active Directory → Overview
* **How:** Copy the "Tenant ID" (a GUID like `xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx`).

### **Client ID**

* **Where:** Azure Portal → Azure Active Directory → App registrations → Your App → Overview
* **How:** Copy the "Application (client) ID".

### **Client Secret**

* **Where:** Azure Portal → Azure Active Directory → App registrations → Your App → Certificates & secrets
* **How:** Create a new client secret and copy its value immediately.

### **User UPN (User Principal Name)**

* **Where:** Microsoft 365 Admin Center → Users → Active users
* **How:** Use the login email (e.g., `user@yourcompany.com`) of the OneDrive user.

### **Drive ID**

* **Where:** Microsoft Graph API or auto-fetched by the connector
* **How:**
  * Use [Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer) with:\
    `GET https://graph.microsoft.com/v1.0/users/{user-upn}/drive`
  * The response contains `"id": "drive-id-here"`.
  * Many connectors fetch this automatically after you enter the User UPN and credentials.

### **Workbook File ID**

* **Where:** In the OneDrive Excel file URL
* **How:**
  * Open your Excel file in OneDrive.
  * The URL will contain a long string after `id=` or `/file/`.
  *   Example:

      ```
      texthttps://onedrive.live.com/edit.aspx?cid=XXXXXX&id=YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY
      ```

      The value after `id=` is your **Workbook File ID**.

### **Access Token**

* **Where:** Generated by the connector
* **How:**
  * The connector will automatically generate and refresh the token using your credentials.

***

### 5. Installation & Initial Setup <a href="#id-5-installation--initial-setup" id="id-5-installation--initial-setup"></a>

### **A. Install the Module**

* Go to **Apps** in Odoo.
* Search for "Excel Online Connector" and install it.

### **B. Configure the Connector**

1. Go to **Settings > Excel Online Connector**.
2. Enter:
   * Tenant ID
   * Client ID
   * Client Secret
   * User UPN
3. Save your configuration.

### **C. Verify Connection**

* The connector will attempt to fetch the Drive ID and generate an access token.
* If successful, you’re ready to create export tasks.

***

### 6. Creating and Managing Export Tasks <a href="#id-6-creating-and-managing-export-tasks" id="id-6-creating-and-managing-export-tasks"></a>

1. **Open the App:** Click "Excel Online Connector" from the Odoo app launcher (nine dots menu).
2. **Create a New Task:**
   * Click **Create**.
   * Enter a **Task Name**.
   * Select the **Odoo Model** to export (e.g., Sales Orders).
   * Choose **Fields to Export** (checkboxes).
   * Enter the **Workbook File ID** (from OneDrive URL).
   * Enter the **Sheet Name** (e.g., "Sheet1").
   * Save the task.

***

### 7. Running an Export <a href="#id-7-running-an-export" id="id-7-running-an-export"></a>

* Open your export task.
* Click **Send to Excel**.
* The connector will:
  * Check if the access token and drive ID are valid.
  * Refresh them if expired.
  * Use the Microsoft Graph API to write the selected Odoo data to your Excel sheet.

***

### 8. Tips for Effective Use <a href="#id-8-tips-for-effective-use" id="id-8-tips-for-effective-use"></a>

* **Field Selection:** Avoid exporting binary/image fields unless necessary.
* **Filters:** Use filters to export only relevant records for speed and clarity.
* **Regular Updates:** Schedule exports for up-to-date data in Excel.
* **Security:** Rotate your Azure credentials periodically and monitor access logs.

***

### 9. Troubleshooting <a href="#id-9-troubleshooting" id="id-9-troubleshooting"></a>

| Issue                        | Solution                                                                                   |
| ---------------------------- | ------------------------------------------------------------------------------------------ |
| Invalid credentials/token    | Double-check Tenant ID, Client ID, Client Secret, and User UPN. Save settings to refresh.  |
| Drive/File not found         | Ensure the Excel file exists in the specified user's OneDrive.                             |
| Permission denied            | Ensure your Azure app has correct Microsoft Graph API permissions (Files.ReadWrite, etc.). |
| Export fails on binary field | Deselect binary/image fields when exporting.                                               |

***

### 10. FAQ <a href="#id-10-faq" id="id-10-faq"></a>

**Q: Where do I find the Workbook File ID?**\
A: In your OneDrive Excel file URL, after `id=`.

**Q: What if my token expires?**\
A: The connector refreshes it automatically using your Azure credentials.

**Q: Can I export to Google Sheets?**\
A: This connector is designed for Excel Online (OneDrive). For Google Sheets, use a different module.

***

### 11. Visual Workflow <a href="#id-11-visual-workflow" id="id-11-visual-workflow"></a>

```
text[User Triggers Export Task]
        ↓
[Connector Checks Token & Drive ID]
        ↓
[If Expired, Refreshes Automatically]
        ↓
[Data Sent to Excel Online via Microsoft Graph API]
        ↓
[User Views/Refreshes Data in Excel]
```

***

### 12. Support & Resources <a href="#id-12-support--resources" id="id-12-support--resources"></a>

* [Microsoft Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer)
* [Odoo Documentation](https://www.odoo.com/documentation/18.0/)
* [Azure Portal](https://portal.azure.com/)
* Your module provider’s support channels

***

### 13. Quick Reference Table <a href="#id-13-quick-reference-table" id="id-13-quick-reference-table"></a>

| Field            | Where to Find / How to Get It                             |
| ---------------- | --------------------------------------------------------- |
| Tenant ID        | Azure Portal → Azure Active Directory → Overview          |
| Client ID        | Azure Portal → App registrations → Your App → Overview    |
| Client Secret    | Azure Portal → App registrations → Certificates & secrets |
| User UPN         | Microsoft 365 Admin Center → Users → Active users         |
| Drive ID         | Graph API: `/users/{user-upn}/drive` or auto-fetched      |
| Workbook File ID | In OneDrive Excel file URL (`id=` parameter)              |
| Access Token     | Auto-generated by connector                               |

***

**For further assistance, consult your system administrator or module provider. Enjoy seamless data integration between Odoo and Excel Online!**
